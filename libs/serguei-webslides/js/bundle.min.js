jQuery(document).ready(function(e){function t(){return window.location.hash?!0:!1}function n(){var t=r(),n=e.grep(t,function(e){return"slide"==e.key});1==n.length&&R(n[0].value)}function r(){for(var e=window.location.hash.replace("#","").split("&"),t=Array([]),n=0;n<e.length;n++){var r=e[n].split("="),o=Object({});o.key=r[0],o.value=r[1],t.push(o)}return t}var o,a={slideshow:"webslides",slide:"slide",counter:"counter",navigation:"navigation",next:"next",previous:"previous",current:"current",verticalClass:"vertical"},i="swing",s=50,c=150,u=-6,l=150,h="ontouchstart"in document.documentElement&&navigator.userAgent.match(/Mobi/),f=jQuery("#"+a.slideshow),p=jQuery("<div>").attr("id","navigation"),d=f.children("section").addClass(a.slide),v=d.first(),m=(d.last(),d.length),g={next:f.hasClass(a.verticalClass)?"&darr;":"&rarr;",previous:f.hasClass(a.verticalClass)?"&uarr;":"&larr;",separator:" / "};jQuery("head").append("<style> .slide:nth-child("+m+") { page-break-after: auto }</style>"),f.children().not("section").remove(),p.append(jQuery('<a href="#" title="Предыдущий">').attr("id",a.previous).html(g.previous)),p.append(jQuery('<a href="#" title="Следующий">').attr("id",a.next).html(g.next)),f.append(p),f.append(jQuery("<span>").attr("id",a.counter));var w=jQuery("#"+a.counter),y=jQuery("#"+a.next),x=jQuery("#"+a.previous);p.append(w);var b=function(){w.text(T.current+g.separator+T.last)},C=function(){var e=""+document.location;1!=e.indexOf("#")&&(e=e.substr(0,e.indexOf("#"))),history.pushState(null,null,"#slide="+T.current)},E=function(){o&&o.hide().removeClass(a.current)};f.data("moving",!1);var j=function(){var e;if(f.hasClass(a.verticalClass)&&!h){if(f.data("moving"))return;f.data("moving",!0),jQuery("html").css({overflow:"hidden"}),e=o.next(),T.current=(T.current+1)%m,0===T.current&&(T.current=m),e.show().addClass(a.current);var t=!1;jQuery("html, body").animate({scrollTop:e.offset().top},500,i,function(){t||(o.hide().removeClass(a.current),o.siblings(".slide").last().after(o),o=e,b(),C(),$(),jQuery("html").css({overflow:"auto"}),setTimeout(function(){f.data("moving",!1)},f.data("iswheel")?c:0)),t=!0})}else jQuery("html, body").animate({scrollTop:0},0),E(),e=o.next(),e.show().addClass(a.current),o.siblings(".slide").last().after(o),o=e,T.current=(T.current+1)%m,0==T.current&&(T.current=m),b(),C(),$()},k=function(){var e;if(f.hasClass(a.verticalClass)&&!h){if(f.data("moving"))return;if(f.data("moving",!0),jQuery("html").css({overflow:"hidden"}),o.before(o.siblings(".slide").last()),e=o.prev(),0===e.length)return!1;e.show().addClass(a.current);var t=!1;jQuery("html, body").scrollTop(o.offset().top),jQuery("html, body").animate({scrollTop:e.offset().top},500,i,function(){t||(o.hide().removeClass(a.current),o=e,o=e,T.current=1==T.current?m:T.current-1,b(),C(),$(),jQuery("html").css({overflow:"auto"}),setTimeout(function(){f.data("moving",!1)},f.data("iswheel")?c:0)),t=!0})}else jQuery("html, body").animate({scrollTop:0},0),E(),o.before(o.siblings(".slide").last()),e=o.prev(),e.show().addClass(a.current),o=e,T.current=1==T.current?m:T.current-1,b(),C(),$()},R=function(e){E(),moveToSlide=e-1,o=d.eq(moveToSlide),o.show().addClass(a.current),jQuery(".slide:lt("+o.index()+")").each(function(){var e=jQuery(this);e.siblings(".slide").last().after(e)}),T.current=e,b()},$=function(e){var t=new window.CustomEvent("slidechanged",{detail:{slide:e||o}});window.dispatchEvent(t)};d.hide();var T={current:1,last:d.length},S=parseInt(document.location.hash.replace("#slide=",""));S&&S>0&&S<=d.length?R(S):(o=v.show().addClass(a.current),b()),y.click(function(e){e.preventDefault(),j()}),x.click(function(e){e.preventDefault(),k()}),jQuery(document).keydown(function(e){if(!f.hasClass(a.verticalClass)||h){if(f.data("iswheel",!1),39==e.which||32==e.which)return j(),!1;if(37==e.which)return k(),!1}}),jQuery(document).keydown(function(e){if(f.hasClass(a.verticalClass)&&!h){if(f.data("iswheel",!1),40==e.which||32==e.which)return j(),!1;if(38==e.which)return k(),!1}}),jQuery(window).bind("hashchange",function(){t()?n():window.location.reload()}),jQuery(window).bind("mousewheel DOMMouseScroll",function(e){f.data("iswheel",!0),f.hasClass(a.verticalClass)&&!h&&(e.originalEvent.wheelDelta>l||e.originalEvent.detail<u?k():(e.originalEvent.wheelDelta<-l||e.originalEvent.detail>-u)&&j())}),jQuery(window).on("touchstart",function(e){var t=e.originalEvent;f.data("touchYStart",t.touches[0].screenY),f.data("touchXStart",t.touches[0].screenX),f.data("touchYEnd",t.touches[0].screenY),f.data("touchXEnd",t.touches[0].screenX)}),jQuery(window).on("touchmove",function(e){var t=e.originalEvent;f.data("touchYEnd",t.touches[0].screenY),f.data("touchXEnd",t.touches[0].screenX)}),jQuery(window).on("touchend",function(e){f.data("iswheel",!1);var t=(e.originalEvent,f.data("touchXStart")-f.data("touchXEnd")),n=f.data("touchYStart")-f.data("touchYEnd");f.hasClass(a.verticalClass)&&!h||Math.abs(t)<=Math.abs(n)||(-s>t?k():t>s&&j())}),jQuery("ul.tabs li").click(function(){var e=jQuery(this),t=e.attr("data-tab");jQuery("ul.tabs li").removeClass("current"),jQuery(".tab-content").removeClass("current"),e.addClass("current"),jQuery("#"+t).addClass("current")}),e.WebSlides=function(){},e.WebSlides.goToSlide=R}),$(document).keypress(function(e){13==e.which&&$("body").toggleClass("baseline").css("height",$(document).height())});
