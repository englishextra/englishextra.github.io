!function(t){"use strict";function e(t,o){if(!(this instanceof e))return new e(t,o);if(!t||"TABLE"!==t.tagName)throw Error("Element must be a table");this.init(t,o||{})}var o=[],s=function(e){var o;return t.CustomEvent&&"function"==typeof t.CustomEvent?o=new CustomEvent(e):(o=document.createEvent("CustomEvent"),o.initCustomEvent(e,!1,!1,void 0)),o},r=function(t){return t.getAttribute("data-sort")||t.textContent||t.innerText||""},n=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),t===e?0:e>t?1:-1},i=function(t,e){return function(o,s){var r=t(o.td,s.td);return 0===r?e?s.index-o.index:o.index-s.index:r}};e.extend=function(t,e,s){if("function"!=typeof e||"function"!=typeof s)throw Error("Pattern and sort must be a function");o.push({name:t,pattern:e,sort:s})},e.prototype={init:function(t,e){var o,s,r,n,i=this;if(i.table=t,i.thead=!1,i.options=e,t.rows&&t.rows.length>0)if(t.tHead&&t.tHead.rows.length>0){for(r=0;r<t.tHead.rows.length;r++)if(t.tHead.rows[r].classList.contains("sort-row")){o=t.tHead.rows[r];break}o||(o=t.tHead.rows[t.tHead.rows.length-1]),i.thead=!0}else o=t.rows[0];if(o){var a=function(){i.current&&i.current!==this&&(i.current.classList.remove("sort-up"),i.current.classList.remove("sort-down")),i.current=this,i.sortTable(this)};for(r=0;r<o.cells.length;r++)n=o.cells[r],n.classList.contains("no-sort")||(n.classList.add("sort-header"),n.tabindex=0,n.addEventListener("click",a,!1),n.classList.contains("sort-default")&&(s=n));s&&(i.current=s,i.sortTable(s))}},sortTable:function(t,e){var a,l=this,d=t.cellIndex,c=n,u="",f=[],h=l.thead?0:1,w=t.getAttribute("data-sort-method"),b=t.getAttribute("data-sort-order");if(l.table.dispatchEvent(s("beforeSort")),e?a=t.classList.contains("sort-up")?"sort-up":"sort-down":(a=t.classList.contains("sort-up")?"sort-down":t.classList.contains("sort-down")?"sort-up":"asc"===b?"sort-down":"desc"===b?"sort-up":l.options.descending?"sort-up":"sort-down",t.classList.remove("sort-down"===a?"sort-up":"sort-down"),t.classList.add(a)),l.table.rows.length>=2){if(!w){for(;f.length<3&&h<l.table.tBodies[0].rows.length;)u=r(l.table.tBodies[0].rows[h].cells[d]),u=u.trim(),u.length>0&&f.push(u),h++;if(!f)return}for(h=0;h<o.length;h++)if(u=o[h],w){if(u.name===w){c=u.sort;break}}else if(f.every(u.pattern)){c=u.sort;break}for(l.col=d,h=0;h<l.table.tBodies.length;h++){var p,v=[],g={},m=0,L=0;if(l.table.tBodies[h].rows.length>=2){for(p=0;p<l.table.tBodies[h].rows.length;p++)u=l.table.tBodies[h].rows[p],u.classList.contains("no-sort")?g[m]=u:v.push({tr:u,td:r(u.cells[l.col]),index:m}),m++;for("sort-down"===a?(v.sort(i(c,!0)),v.reverse()):v.sort(i(c,!1)),p=0;m>p;p++)g[p]?(u=g[p],L++):u=v[p-L].tr,l.table.tBodies[h].appendChild(u)}}l.table.dispatchEvent(s("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=e:t.Tablesort=e}("object"==typeof window&&window||"object"==typeof self&&self||"object"==typeof global&&global||{});
