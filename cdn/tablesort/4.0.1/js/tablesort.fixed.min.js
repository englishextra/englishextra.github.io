!function(){function t(e,o){if(!(this instanceof t))return new t(e,o);if(!e||"TABLE"!==e.tagName)throw new Error("Element must be a table");this.init(e,o||{})}if("undefined"==typeof window||!("document"in window))return console.log("window is undefined or document is not in window"),!1;var e=[],o=function(t){var e;return window.CustomEvent&&"function"==typeof window.CustomEvent?e=new CustomEvent(t):(e=document.createEvent("CustomEvent"),e.initCustomEvent(t,!1,!1,void 0)),e},n=function(t){return t.getAttribute("data-sort")||t.textContent||t.innerText||""},s=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),t===e?0:e>t?1:-1},r=function(t,e){return function(o,n){var s=t(o.td,n.td);return 0===s?e?n.index-o.index:o.index-n.index:s}};t.extend=function(t,o,n){if("function"!=typeof o||"function"!=typeof n)throw new Error("Pattern and sort must be a function");e.push({name:t,pattern:o,sort:n})},t.prototype={init:function(t,e){var o,n,s,r,i=this;if(i.table=t,i.thead=!1,i.options=e,t.rows&&t.rows.length>0)if(t.tHead&&t.tHead.rows.length>0){for(s=0;s<t.tHead.rows.length;s++)if(t.tHead.rows[s].classList.contains("sort-row")){o=t.tHead.rows[s];break}o||(o=t.tHead.rows[t.tHead.rows.length-1]),i.thead=!0}else o=t.rows[0];if(o){var a=function(){i.current&&i.current!==this&&(i.current.classList.remove("sort-up"),i.current.classList.remove("sort-down")),i.current=this,i.sortTable(this)};for(s=0;s<o.cells.length;s++)r=o.cells[s],r.classList.contains("no-sort")||(r.classList.add("sort-header"),r.tabindex=0,r.addEventListener("click",a,!1),r.classList.contains("sort-default")&&(n=r));n&&(i.current=n,i.sortTable(n))}},sortTable:function(t,i){var a,d=this,l=t.cellIndex,c=s,u="",f=[],w=d.thead?0:1,h=t.getAttribute("data-sort-method"),p=t.getAttribute("data-sort-order");if(d.table.dispatchEvent(o("beforeSort")),i?a=t.classList.contains("sort-up")?"sort-up":"sort-down":(a=t.classList.contains("sort-up")?"sort-down":t.classList.contains("sort-down")?"sort-up":"asc"===p?"sort-down":"desc"===p?"sort-up":d.options.descending?"sort-up":"sort-down",t.classList.remove("sort-down"===a?"sort-up":"sort-down"),t.classList.add(a)),!(d.table.rows.length<2)){if(!h){for(;f.length<3&&w<d.table.tBodies[0].rows.length;)u=n(d.table.tBodies[0].rows[w].cells[l]),u=u.trim(),u.length>0&&f.push(u),w++;if(!f)return}for(w=0;w<e.length;w++)if(u=e[w],h){if(u.name===h){c=u.sort;break}}else if(f.every(u.pattern)){c=u.sort;break}for(d.col=l,w=0;w<d.table.tBodies.length;w++){var b,v=[],m={},g=0,L=0;if(!(d.table.tBodies[w].rows.length<2)){for(b=0;b<d.table.tBodies[w].rows.length;b++)u=d.table.tBodies[w].rows[b],u.classList.contains("no-sort")?m[g]=u:v.push({tr:u,td:n(u.cells[d.col]),index:g}),g++;for("sort-down"===a?(v.sort(r(c,!0)),v.reverse()):v.sort(r(c,!1)),b=0;g>b;b++)m[b]?(u=m[b],L++):u=v[b-L].tr,d.table.tBodies[w].appendChild(u)}}d.table.dispatchEvent(o("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=t:window.Tablesort=t}();